pipeline {
    environment{
        SCANNER_HOME=tool 'DOTT'
    }
    agent any



    stages {

        stage('Test') {

            steps {

                echo 'Unit testing'

                sh '''

                python3 --version

                cd ./cidr_convert_api/python/

		 tests.py

                '''                

            }

        }



        stage('SonarCloud Static Analysis') {
            steps {
               sh ' cd cidr_convert_api/python/ '
                sh '''
                    withSonarQubeEnv('sonarDOTT') {
                         sonar-scanner \
                        -Dsonar.organization=violetadfs \
                        -Dsonar.projectKey=violetadfs_proyectofinalvioleta \
                        -Dsonar.sources=. \
                        -Dsonar.host.url=https://sonarcloud.io
                    '''
            }
           
        }

    }

}
